<!DOCTYPE HTML>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <meta name="generator" content="nico 0.5.0">
    <meta name="theme" content="KISS 0.1">
    <title>阶乘(factorial) &amp; 尾递归(Tail Recursion) - 闲耘™.博客</title>
    <link rel="alternate" type="application/rss+xml" href="http://blog.hotoo.me/feed.xml" title="闲耘™.博客" />
    <link rel="stylesheet" href="../static/syntax.css" />
    <link type="text/css" rel="stylesheet" href="../static/template.css" />
  </head>
  <body>
  <div id="wrapper">
    <header class="navigation" role="navigation">
      <!--<a class="home" href="../">闲耘™.博客</a>-->
      <div style="float:right;">
        <form action="/search.html">
          <input type="text" name="q" autocomplete="off" />
          <input type="submit" value="搜索" />
        </form>
      </div>
      <nav class="menu">
        <ul>
          <li class="first"><a href="http://hotoo.me/"
            title="Home">Home</a></li>
          <li class=" actived"><a href="/"
            title="Blog">Blog</a></li>
          <li class=""><a href="http://wiki.hotoo.me/"
            title="Wiki">Wiki</a></li>
          <li class=""><a href="http://wiki.hotoo.me/Vim.html"
            title="Vim">Vim</a></li>
          <li class=""><a href="http://twitter.hotoo.me/"
            title="Twitter">Twitter</a></li>
          <li class="last"><a href="https://github.com/hotoo"
            title="Project">Project</a></li>
        </ul>
      </nav>
    </header>

<div id="container">
  <div id="content" class="document">
<div class="hentry">
  <h1 class="entry-title">阶乘(factorial) &amp; 尾递归(Tail Recursion)</h1>
  <div class="entry-content"><p>今天看了dennis的《<a href="http://www.blogjava.net/killme2008/archive/2008/03/18/187071.html">用递归计算阶乘咋不行呢？</a>》
受益良多，这里做下小结。</p>
<p>传统的递归算法写起来很漂亮，代码很简洁，但是每递归一次就需要更深一层的堆栈支持，
可能会造成内存溢出而失败，所以递归和goto语句一样声名狼藉。</p>
<blockquote>
<p>甚至《代码大全》的作者有这样一句话：如果为我工作的程序员用递归去计算阶乘，那么我宁愿换人。
作者对递归的态度相当谨慎，这在静态命令式语言中显然是正确的，但是在函数式语言中，
由于有尾递归优化的存在，递归反而是最自然的形式，况且我打心里认为递归更符合人类思维。
(by dennis)</p>
</blockquote>
<p>尾递归就是从最后开始计算，每递归一次就算出相应的结果，
也就是说，函数调用出现在调用者函数的尾部，因为是尾部，
所以根本没有必要去保存任何局部变量，直接让被调用的函数返回时越过调用者，
返回到调用者的调用者去。举例说明。</p>
<p>线性递归（传统递归方式）：</p><div class="highlight"><div class="codes"><div class="code"><pre><code class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">recursion</span><span class="params">(n)</span>{</span>
    <span class="keyword">return</span> n==<span class="number">1</span>?<span class="number">1</span>:n*recursion(n-<span class="number">1</span>);
}</code></pre></div><pre class="line"><a name="L1-1" href="#L1-1">1</a>
<a name="L1-2" href="#L1-2">2</a></pre></div></div><p>尾递归：</p><div class="highlight"><div class="codes"><div class="code"><pre><code class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">tailRecursion</span><span class="params">(n, a)</span>{</span>
    a = a||<span class="number">1</span>; <span class="comment">// 尾递归之尾，即上次递归结果。</span>
    <span class="keyword">return</span> n==<span class="number">1</span>?a:tailRecursion(n-<span class="number">1</span>, a*n);
}</code></pre></div><pre class="line"><a name="L2-1" href="#L2-1">1</a>
<a name="L2-2" href="#L2-2">2</a>
<a name="L2-3" href="#L2-3">3</a></pre></div></div><p>这里将基于尾递归的求数值阶乘算法贴下：</p><div class="highlight"><div class="codes"><div class="code"><pre><code class="javascript">Math.factorial_III = <span class="function"><span class="keyword">function</span><span class="params">(n)</span>{</span>
    <span class="keyword">var</span> a = arguments[<span class="number">1</span>]||<span class="number">1</span>;
    <span class="keyword">return</span> n&lt;=<span class="number">1</span>?a:Math.factorial_III(n-<span class="number">1</span>, a*n);
};</code></pre></div><pre class="line"><a name="L3-1" href="#L3-1">1</a>
<a name="L3-2" href="#L3-2">2</a>
<a name="L3-3" href="#L3-3">3</a></pre></div></div><p>效率上和循环迭代、<a href="http://blog.xianyun.org/2007/12/26/improved-factorial/">阶乘改进算法</a>
相当甚至稍胜出（ie6,firefox2,safari3），普通递归的效率最为底下，且需要深入堆栈。</p>
<h1 id="参考">参考</h1><ul>
<li>《<a href="http://baike.baidu.com/view/1439396.htm">尾递归</a>》-百度百科</li>
<li>《<a href="http://www.blogjava.net/killme2008/archive/2008/03/18/187071.html">用递归计算阶乘咋不行呢？</a>》-dennis</li>
</ul>
</div>

  <footer class="entry-meta post clearfix">
    <span class="tags"><a href="/tag">Tags</a>:
 
      <a href="/tag/#算法">算法</a>
      
    </span>

    <time datetime="2008-04-08T00:00:00.000Z">
      <a href="/2008">2008年</a>04月08日
    </time>
  </footer>
    <section>
      <div id="disqus_thread"></div>
      <noscript>
        要查看或参与评论，请启用 JavaScript 支持。<br />
        Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript=hotoo">comments powered by Disqus.</a>
      </noscript>
    </section>
  <script type="text/javascript">
    
    var disqus_identifier = "factorial-recursion";
    
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = 'http://hotoo.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  </script>
</div>
</div>

    <!-- Vimlike status bar -->
    <div id="status-bar">
        <span id="count"></span>
    </div>
</div>
<div id="helper-box"></div>
<div id="helper" tabindex="1">
    <table>
    <thead>
        <tr>
            <th colspan="2">Help</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <th width="120">[count]gg</th>
            <td>跳转到第 [count] 行，默认第 1 行。</td>
        </tr>
        <tr>
            <th>[count]G</th>
            <td>跳转到第 [count] 行，默认最后一行。</td>
        </tr>
        <tr>
            <th>[count]j</th>
            <td>向下跳转 [count] 行，默认跳转一行。</td>
        </tr>
        <tr>
            <th>[count]k</th>
            <td>向上跳转 [count] 行，默认跳转一行。</td>
        </tr>
        <tr>
            <th>/</th>
            <td>开始搜索。按 &lt;Esc&gt; 退出。</td>
        </tr>
        <tr>
            <th>gh</th>
            <td>跳转到首页。</td>
        </tr>
        <tr>
            <th>gb</th>
            <td>跳转到博客首页。</td>
        </tr>
        <tr>
            <th>gw</th>
            <td>跳转到 Wiki 首页。</td>
        </tr>
        <tr>
            <th>gt</th>
            <td>跳转到我的 Twitter Profile 页。</td>
        </tr>
        <tr>
            <th>gp</th>
            <td>跳转到我的 Github Profile 页。</td>
        </tr>
        <tr>
            <th>?</th>
            <td>打开帮助。按 &lt;Esc&gt; 退出。</td>
        </tr>
    </tbody>
    </table>
</div>

<script type="text/javascript" src="/static/js/Vimlike.js"></script>
<footer>
  <p><a rel="license" href="http://creativecommons.org/licenses/by/2.5/"><img
    alt="Creative Commons License" style="border-width: 0pt;"
    src="http://i.creativecommons.org/l/by/2.5/88x31.png" align="right"/></a>
  This work is licensed under a
  <a rel="license" href="http://creativecommons.org/licenses/by/2.5/">Creative
    Commons Attribution 2.5 Generic License</a>.<br/>
  Copyleft &copy; 2005-2013, Power by
  <a href="http://lab.lepture.com/nico/">nico@0.5.0</a>, Theme by 闲耘™(@hotoo).
  </p>
</footer>
</div>
<script type="text/javascript">
var gaJsHost=(("https:"==document.location.protocol)?"https://ssl.":"http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
  var pageTracker=_gat._getTracker("UA-2048484-1");
  pageTracker._trackPageview();
}catch(err){}</script>

  </body>
</html>